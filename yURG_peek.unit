#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include yURG header                  yURG.h                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include yURG private header          yURG_priv.h                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0a]  (MSG) verify checking file existance                               0s   exist           yURG_detail, yURG_exists                                                     ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yURG__testquiet                                                                                                                   i_equal     0                                                                                                    

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/etc"                                 ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     'd'                                                                                                  
     exec     call exists                          yURG_exists                 "/etc"                                                                                                c_equal     'd'                                                                                                  

   COND       attempt missing file                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/nowhereville"                        ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     '-'                                                                                                  
     exec     call exists                          yURG_exists                 "/nowhereville"                                                                                       c_equal     '-'                                                                                                  

   COND       attempt illegal names                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 NULL                                   ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   i_lesser    0                                                                                                    
     exec     call exists                          yURG_exists                 NULL                                                                                                  i_lesser    0                                                                                                    
     exec     call detail                          yURG_detail                 ""                                     ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   i_lesser    0                                                                                                    
     exec     call exists                          yURG_exists                 ""                                                                                                    i_lesser    0                                                                                                    

   COND       verify symbolic link                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/lib"                                 ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     's'                                                                                                  
     exec     call exists                          yURG_exists                 "/lib"                                                                                                c_equal     's'                                                                                                  

   COND       verify regular file                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/var/lib/polymnia/polymnia.db"        ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     'r'                                                                                                  
     exec     call exists                          yURG_exists                 "/var/lib/polymnia/polymnia.db"                                                                       c_equal     'r'                                                                                                  

   COND       verify block device                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/dev/sda"                             ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     'b'                                                                                                  
     exec     call exists                          yURG_exists                 "/dev/sda"                                                                                            c_equal     'b'                                                                                                  

   COND       verify character device                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call detail                          yURG_detail                 "/dev/tty0"                            ,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL   c_equal     'c'                                                                                                  
     exec     call exists                          yURG_exists                 "/dev/tty0"                                                                                           c_equal     'c'                                                                                                  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yURG__testend                                                                                                                     i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0b]  (MSG) verify simple regular file creation and removal              0s   touch           yURG_touch, yURG_rm                                                          ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yURG__testquiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char       *x_name  = "/tmp/right_here.txt";                                                                                                                                                                               
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     '-'                                                                                                  
     exec     call touch                           yURG_touch                  x_name                                , "member"       , "users"        , "0755"                      c_equal     'r'                                                                                                  
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     'r'                                                                                                  

   COND       verify removing the file                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     'r'                                                                                                  
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     '-'                                                                                                  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up testing                      yURG__testend                                                                                                                     i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP    [0c]  (MSG) verify changes in ownership and permissions                  0s   chars           yURG_details                                                                 ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     prepare for testing                  yURG__testquiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char       *x_name  = "/tmp/right_here.txt";                                                                                                                                                                               
     local    create working variable              - - - - - - - - - - - - -   int        io, ig, ip;                                                                                                                                                                                                     
     local    create working variable              - - - - - - - - - - - - -   char       no  [LEN_LABEL];                                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   char       ng  [LEN_LABEL];                                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   char       np  [LEN_LABEL];                                                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   char       dp  [LEN_LABEL];                                                                                                                                                                                                
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  

   COND       verify quick success                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call touch                           yURG_touch                  x_name                                 , "member"       , "users"        , "0755"                     c_equal     'r'                                                                                                  
     exec     call detail                          yURG_detail                 x_name                                 , &io, no , &ig, ng , &ip, np , dp ,NULL,NULL,NULL,NULL,NULL   c_equal     'r'                                                                                                  
     echo     ... check owner id                   - - - - - - - - - - - - -   io                                                                                                    i_equal     1000                                                                                                 
     echo     ... check owner name                 - - - - - - - - - - - - -   no                                                                                                    w_equal     åmemberæ                                                                                             
     echo     ... check group id                   - - - - - - - - - - - - -   ig                                                                                                    i_equal     100                                                                                                  
     echo     ... check group name                 - - - - - - - - - - - - -   ng                                                                                                    w_equal     åusersæ                                                                                              
     echo     ... check permissions                - - - - - - - - - - - - -   ip                                                                                                    i_equal     0755                                                                                                 
     echo     ... check perm name                  - - - - - - - - - - - - -   np                                                                                                    w_equal     åd_normalæ                                                                                           
     echo     ... check perm display               - - - - - - - - - - - - -   dp                                                                                                    w_equal     årwxr-xr-xæ                                                                                          

   COND       verify changing existing file                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call touch                           yURG_touch                  x_name                                 , "root"         , "daemon"       , "0000"                     c_equal     'r'                                                                                                  
     exec     call detail                          yURG_detail                 x_name                                 , &io, no , &ig, ng , &ip, np , dp ,NULL,NULL,NULL,NULL,NULL   c_equal     'r'                                                                                                  
     echo     ... check owner id                   - - - - - - - - - - - - -   io                                                                                                    i_equal     0                                                                                                    
     echo     ... check owner name                 - - - - - - - - - - - - -   no                                                                                                    w_equal     årootæ                                                                                               
     echo     ... check group id                   - - - - - - - - - - - - -   ig                                                                                                    i_equal     2                                                                                                    
     echo     ... check group name                 - - - - - - - - - - - - -   ng                                                                                                    w_equal     ådaemonæ                                                                                             
     echo     ... check permissions                - - - - - - - - - - - - -   ip                                                                                                    i_equal     0000                                                                                                 
     echo     ... check perm name                  - - - - - - - - - - - - -   np                                                                                                    w_equal     år_onlyæ                                                                                             
     echo     ... check perm display               - - - - - - - - - - - - -   dp                                                                                                    w_equal     å---------æ                                                                                          

   COND       verify changing using standard permission name                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call touch                           yURG_touch                  x_name                                 , "nobody"       , "sys"          , "f_normal"                 c_equal     'r'                                                                                                  
     exec     call detail                          yURG_detail                 x_name                                 , &io, no , &ig, ng , &ip, np , dp ,NULL,NULL,NULL,NULL,NULL   c_equal     'r'                                                                                                  
     echo     ... check owner id                   - - - - - - - - - - - - -   io                                                                                                    i_equal     65534                                                                                                
     echo     ... check owner name                 - - - - - - - - - - - - -   no                                                                                                    w_equal     ånobodyæ                                                                                             
     echo     ... check group id                   - - - - - - - - - - - - -   ig                                                                                                    i_equal     3                                                                                                    
     echo     ... check group name                 - - - - - - - - - - - - -   ng                                                                                                    w_equal     åsysæ                                                                                                
     echo     ... check permissions                - - - - - - - - - - - - -   ip                                                                                                    i_equal     0644                                                                                                 
     echo     ... check perm name                  - - - - - - - - - - - - -   np                                                                                                    w_equal     åf_normalæ                                                                                           
     echo     ... check perm display               - - - - - - - - - - - - -   dp                                                                                                    w_equal     årw-r--r--æ                                                                                          

   COND       verify changing using permission string                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , "rwx-----T"                c_equal     'r'                                                                                                  
     exec     call detail                          yURG_detail                 x_name                                 , &io, no , &ig, ng , &ip, np , dp ,NULL,NULL,NULL,NULL,NULL   c_equal     'r'                                                                                                  
     echo     ... check owner id                   - - - - - - - - - - - - -   io                                                                                                    i_equal     250                                                                                                  
     echo     ... check owner name                 - - - - - - - - - - - - -   no                                                                                                    w_equal     åportageæ                                                                                            
     echo     ... check group id                   - - - - - - - - - - - - -   ig                                                                                                    i_equal     10                                                                                                   
     echo     ... check group name                 - - - - - - - - - - - - -   ng                                                                                                    w_equal     åwheelæ                                                                                              
     echo     ... check permissions                - - - - - - - - - - - - -   ip                                                                                                    i_equal     01700                                                                                                
     echo     ... check perm name                  - - - - - - - - - - - - -   np                                                                                                    w_equal     åd_tightsæ                                                                                           
     echo     ... check perm display               - - - - - - - - - - - - -   dp                                                                                                    w_equal     årwx-----Tæ                                                                                          

   COND       attempt with bad owner                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  
     exec     call touch                           yURG_touch                  x_name                                 , NULL           , "wheel"        , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , ""             , "wheel"        , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "whowho"       , "wheel"        , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     '-'                                                                                                  

   COND       attempt with bad group                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , NULL           , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , ""             , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "JUMBO"        , "rwx-----T"                i_lesser    0                                                                                                    
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     '-'                                                                                                  

   COND       attempt with bad permissions                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , NULL                       i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , ""                         i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , "jwx-----T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , "rwx--y--T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , "rwx--r--T"                i_lesser    0                                                                                                    
     exec     call touch                           yURG_touch                  x_name                                 , "portage"      , "wheel"        , "rwx-----s"                i_lesser    0                                                                                                    
     exec     call exist                           yURG_exists                 x_name                                                                                                c_equal     '-'                                                                                                  

   COND       end the test                                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call remove                          yURG_rm                     x_name                                                                                                c_equal     '-'                                                                                                  
     exec     wrap up testing                      yURG__testend                                                                                                                     i_equal     0                                                                                                    


